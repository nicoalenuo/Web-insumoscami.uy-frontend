<h4>PENDIENTES</h4>
<div class="card">
    <p-table [value]="pedidos_pendientes" dataKey="id">
        <ng-template pTemplate="header">
            <tr>
                <th></th>
                <th>Id</th>
                <th>Creado</th>
                <th>Email</th>
                <th>Estado</th>
                <th>Compra online</th>
                <th>Opciones</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-pedido let-expanded="expanded">
            <tr>
                <td>
                    <button
                        type="button"
                        pButton
                        pRipple
                        [pRowToggler]="pedido"
                        class="p-button-text p-button-rounded p-button-plain"
                        [icon]="
                            expanded
                                ? 'pi pi-chevron-down'
                                : 'pi pi-chevron-right'
                        "
                    ></button>
                </td>
                <td>
                    {{ pedido.id }}
                </td>
                <td>
                    {{ pedido.fechaCreacion | date : "yyyy-MM-dd" }}
                </td>
                <td>
                    {{ pedido.user_mail }}
                </td>
                <td>{{ pedido.estado }}</td>
                <td>{{ pedido.es_online ? "SI" : "NO" }}</td>
                <td class="flex gap-3">
                    <p-button
                        (click)="rechazarPedido(pedido)"
                        icon="pi pi-times"
                        [rounded]="true"
                        severity="danger"
                        [outlined]="true"
                    ></p-button>
                    <p-button
                        (click)="aceptarPedido(pedido)"
                        icon="pi pi-check"
                        [rounded]="true"
                        [outlined]="true"
                    ></p-button>
                </td>
            </tr>
        </ng-template>

        <ng-template pTemplate="rowexpansion" let-pedido>
            <tr>
                <td colspan="4">
                    <p-table [value]="pedido.items" dataKey="id">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>Imagen</th>
                                <th>Id</th>
                                <th>Nombre</th>
                                <th>Cantidad</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-item>
                            <tr>
                                <td>
                                    <div style="width: 80px">
                                        <img
                                            [src]="
                                                item.url_imagen
                                                    ? obtenerUrl(
                                                          item.url_imagen
                                                      )
                                                    : '/assets/shared/default-product.webp'
                                            "
                                            class="img-fluid"
                                            alt="Shopping item"
                                        />
                                    </div>
                                </td>
                                <td>{{ item.item_id }}</td>
                                <td>{{ item.title }}</td>
                                <td>{{ item.quantity }}</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<!-- PEDIDOS ACEPTADOS O RECHAZADOS -->
<h4 class="mt-5">ACEPTADOS O RECHAZADOS</h4>
<div class="card">
    <p-table [value]="pedidos_aceptados_rechazados" dataKey="id">
        <ng-template pTemplate="header">
            <tr>
                <th></th>
                <th>Id</th>
                <th>Creado</th>
                <th>Email</th>
                <th>Estado</th>
                <th>Compra online</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-pedido let-expanded="expanded">
            <tr>
                <td>
                    <button
                        type="button"
                        pButton
                        pRipple
                        [pRowToggler]="pedido"
                        class="p-button-text p-button-rounded p-button-plain"
                        [icon]="
                            expanded
                                ? 'pi pi-chevron-down'
                                : 'pi pi-chevron-right'
                        "
                    ></button>
                </td>
                <td>
                    {{ pedido.id }}
                </td>
                <td>
                    {{ pedido.fechaCreacion | date : "yyyy-MM-dd" }}
                </td>
                <td>
                    {{ pedido.user_mail }}
                </td>
                <td>{{ pedido.estado }}</td>
                <td>{{ pedido.es_online ? "SI" : "NO" }}</td>
            </tr>
        </ng-template>

        <ng-template pTemplate="rowexpansion" let-pedido>
            <tr>
                <td colspan="4">
                    <p-table [value]="pedido.items" dataKey="id">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>Imagen</th>
                                <th>Id</th>
                                <th>Nombre</th>
                                <th>Cantidad</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-item>
                            <tr>
                                <td>
                                    <div style="width: 80px">
                                        <img
                                            [src]="
                                                item.url_imagen
                                                    ? obtenerUrl(
                                                          item.url_imagen
                                                      )
                                                    : '/assets/shared/default-product.webp'
                                            "
                                            class="img-fluid"
                                            alt="Shopping item"
                                        />
                                    </div>
                                </td>
                                <td>{{ item.item_id }}</td>
                                <td>{{ item.title }}</td>
                                <td>{{ item.quantity }}</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
